"use strict";function assign(t,i){if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),a=1;a<arguments.length;a++){var n=arguments[a];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}function findRange(t,i,e){if(isNaN(t))throw new Error("[wxCharts] unvalid series data!");e=e||10,i=i||"upper";for(var a=1;e<1;)e*=10,a*=10;for(t="upper"===i?Math.ceil(t*a):Math.floor(t*a);t%e!=0;)"upper"===i?t++:t--;return t/a}function calValidDistance(t,i,e,a){var n=a.width-e.padding-i.xAxisPoints[0],o=i.eachSpacing*a.categories.length,r=t;return t>=0?r=0:Math.abs(t)>=o-n&&(r=n-o),r}function isInAngleRange(t,i,e){function a(t){for(;t<0;)t+=2*Math.PI;for(;t>2*Math.PI;)t-=2*Math.PI;return t}return t=a(t),i=a(i),e=a(e),i>e&&(e+=2*Math.PI,t<i&&(t+=2*Math.PI)),t>=i&&t<=e}function calRotateTranslate(t,i,e){var a=t,n=e-i,o=a+(e-n-a)/Math.sqrt(2);return o*=-1,{transX:o,transY:(e-n)*(Math.sqrt(2)-1)-(e-n-a)/Math.sqrt(2)}}function createCurveControlPoints(t,i){function e(t,i){return!(!t[i-1]||!t[i+1])&&(t[i].y>=Math.max(t[i-1].y,t[i+1].y)||t[i].y<=Math.min(t[i-1].y,t[i+1].y))}var a=null,n=null,o=null,r=null;if(i<1?(a=t[0].x+.2*(t[1].x-t[0].x),n=t[0].y+.2*(t[1].y-t[0].y)):(a=t[i].x+.2*(t[i+1].x-t[i-1].x),n=t[i].y+.2*(t[i+1].y-t[i-1].y)),i>t.length-3){var s=t.length-1;o=t[s].x-.2*(t[s].x-t[s-1].x),r=t[s].y-.2*(t[s].y-t[s-1].y)}else o=t[i+1].x-.2*(t[i+2].x-t[i].x),r=t[i+1].y-.2*(t[i+2].y-t[i].y);return e(t,i+1)&&(r=t[i+1].y),e(t,i)&&(n=t[i].y),{ctrA:{x:a,y:n},ctrB:{x:o,y:r}}}function convertCoordinateOrigin(t,i,e){return{x:e.x+t,y:e.y-i}}function avoidCollision(t,i){if(i)for(;util.isCollision(t,i);)t.start.x>0?t.start.y--:t.start.x<0?t.start.y++:t.start.y>0?t.start.y++:t.start.y--;return t}function fillSeriesColor(t,i){var e=0;return t.map(function(t){return t.color||(t.color=i.colors[e],e=(e+1)%i.colors.length),t})}function getDataRange(t,i){var e=0,a=i-t;return e=a>=1e4?1e3:a>=1e3?100:a>=100?10:a>=10?5:a>=1?1:a>=.1?.1:.01,{minRange:findRange(t,"lower",e),maxRange:findRange(i,"upper",e)}}function measureText(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;t=String(t);var t=t.split(""),e=0;return t.forEach(function(t){/[a-zA-Z]/.test(t)?e+=7:/[0-9]/.test(t)?e+=5.5:/\./.test(t)?e+=2.7:/-/.test(t)?e+=3.25:/[\u4e00-\u9fa5]/.test(t)?e+=10:/\(|\)/.test(t)?e+=3.73:/\s/.test(t)?e+=2.5:/%/.test(t)?e+=8:e+=10}),e*i/10}function dataCombine(t){return t.reduce(function(t,i){return(t.data?t.data:t).concat(i.data)},[])}function getSeriesDataItem(t,i){var e=[];return t.forEach(function(t){if(null!==t.data[i]&&"undefinded"!=typeof t.data[i]){var a={};a.color=t.color,a.name=t.name,a.data=t.format?t.format(t.data[i]):t.data[i],e.push(a)}}),e}function getMaxTextListLength(t){var i=t.map(function(t){return measureText(t)});return Math.max.apply(null,i)}function getRadarCoordinateSeries(t){for(var i=2*Math.PI/t,e=[],a=0;a<t;a++)e.push(i*a);return e.map(function(t){return-1*t+Math.PI/2})}function getToolTipData(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=t.map(function(t){return{text:n.format?n.format(t,a[e]):t.name+": "+t.data,color:t.color}}),r=[],s={x:0,y:0};return i.forEach(function(t){"undefinded"!=typeof t[e]&&null!==t[e]&&r.push(t[e])}),r.forEach(function(t){s.x=Math.round(t.x),s.y+=t.y}),s.y/=r.length,{textList:o,offset:s}}function findCurrentIndex(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=-1;return isInExactChartArea(t,e,a)&&i.forEach(function(i,e){t.x+n>i&&(o=e)}),o}function isInExactChartArea(t,i,e){return t.x<i.width-e.padding&&t.x>e.padding+e.yAxisWidth+e.yAxisTitleWidth&&t.y>e.padding&&t.y<i.height-e.legendHeight-e.xAxisHeight-e.padding}function findRadarChartCurrentIndex(t,i,e){var a=2*Math.PI/e,n=-1;if(isInExactPieChartArea(t,i.center,i.radius)){var o=function(t){return t<0&&(t+=2*Math.PI),t>2*Math.PI&&(t-=2*Math.PI),t},r=Math.atan2(i.center.y-t.y,t.x-i.center.x);r*=-1,r<0&&(r+=2*Math.PI);i.angleList.map(function(t){return t=o(-1*t)}).forEach(function(t,i){var e=o(t-a/2),s=o(t+a/2);s<e&&(s+=2*Math.PI),(r>=e&&r<=s||r+2*Math.PI>=e&&r+2*Math.PI<=s)&&(n=i)})}return n}function findPieChartCurrentIndex(t,i){var e=-1;if(isInExactPieChartArea(t,i.center,i.radius)){var a=Math.atan2(i.center.y-t.y,t.x-i.center.x);a=-a;for(var n=0,o=i.series.length;n<o;n++){var r=i.series[n];if(isInAngleRange(a,r._start_,r._start_+2*r._proportion_*Math.PI)){e=n;break}}}return e}function isInExactPieChartArea(t,i,e){return Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2)<=Math.pow(e,2)}function splitPoints(t){var i=[],e=[];return t.forEach(function(t,a){null!==t?e.push(t):(e.length&&i.push(e),e=[])}),e.length&&i.push(e),i}function calLegendData(t,i,e){if(!1===i.legend)return{legendList:[],legendHeight:0};var a=[],n=0,o=[];return t.forEach(function(t){var e=30+measureText(t.name||"undefinded");n+e>i.width?(a.push(o),n=e,o=[t]):(n+=e,o.push(t))}),o.length&&a.push(o),{legendList:a,legendHeight:a.length*(e.fontSize+8)+5}}function calCategoriesData(t,i,e){var a={angle:0,xAxisHeight:e.xAxisHeight},n="column-line"===i.type?getColumnLineXAxisPoints(t,i,e):getXAxisPoints(t,i,e),o=n.eachSpacing,r=t.map(function(t){return measureText(t)}),s=Math.max.apply(this,r);return s+2*e.xAxisTextPadding>o&&(a.angle=45*Math.PI/180,a.xAxisHeight=2*e.xAxisTextPadding+s*Math.sin(a.angle)),a}function getRadarDataPoints(t,i,e,a,n){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,r=n.extra.radar||{};r.max=r.max||0;var s=Math.max(r.max,Math.max.apply(null,dataCombine(a))),l=[];return a.forEach(function(a){var n={};n.color=a.color,n.data=[],a.data.forEach(function(a,r){var l={};l.angle=t[r],l.proportion=a/s,l.position=convertCoordinateOrigin(e*l.proportion*o*Math.cos(l.angle),e*l.proportion*o*Math.sin(l.angle),i),n.data.push(l)}),l.push(n)}),l}function getPieDataPoints(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,e=0,a=0;return t.forEach(function(t){t.data=null===t.data?0:t.data,e+=t.data}),t.forEach(function(t){t.data=null===t.data?0:t.data,t._proportion_=t.data/e*i}),t.forEach(function(t){t._start_=a,a+=2*t._proportion_*Math.PI}),t}function getPieTextMaxLength(t){t=getPieDataPoints(t);var i=0;return t.forEach(function(t){var e=t.format?t.format(+t._proportion_.toFixed(2)):util.toFixed(100*t._proportion_)+"%";i=Math.max(i,measureText(e))}),i}function fixColumeData(t,i,e,a,n,o){return t.map(function(t){return null===t?null:(t.width=(i-2*n.columePadding)/e,o.extra.column&&o.extra.column.width&&+o.extra.column.width>0?t.width=Math.min(t.width,+o.extra.column.width):t.width=Math.min(t.width,25),t.x+=(a+.5-e/2)*t.width,t)})}function fixCumulativeData(t,i,e){return t.map(function(t){return null===t?null:(t.width=i-2*e.columePadding,t.width=Math.min(t.width,25),t)})}function getXAxisPoints(t,i,e){var a=e.yAxisWidth+e.yAxisTitleWidth,n=i.width-2*e.padding-a,o=i.enableScroll?Math.min(5,t.length):t.length,r=n/o,s=[],l=e.padding+a,h=i.width-e.padding;return t.forEach(function(t,i){s.push(l+i*r)}),!0===i.enableScroll?s.push(l+t.length*r):s.push(h),{xAxisPoints:s,startX:l,endX:h,eachSpacing:r}}function getColumnLineXAxisPoints(t,i,e){var a=e.columnLine.leftYAxisWidth+e.columnLine.leftYAxisTitleWidth,n=e.columnLine.rightYAxisWidth+e.columnLine.rightYAxisTitleWidth,o=i.width-2*e.padding-a-n,r=o/t.length,s=[],l=e.padding+a,h=i.width-e.padding-n;return t.forEach(function(t,i){s.push(l+i*r)}),s.push(h),{xAxisPoints:s,startX:l,endX:h,eachSpacing:r}}function getDataPoints(t,i,e,a,n,o,r){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,l=[],h=o.height-2*r.padding-r.xAxisHeight-r.legendHeight;return t.forEach(function(t,c){if(null===t)l.push(null);else{var d={};d.x=a[c]+Math.round(n/2);var x=h*(t-i)/(e-i);x*=s,d.y=o.height-r.xAxisHeight-r.legendHeight-Math.round(x)-r.padding,l.push(d)}}),l}function getYAxisTextList(t,i,e){var a="yAxis";"left"===t[0].position&&(a="leftYAxis"),"right"===t[0].position&&(a="rightYAxis");var n=dataCombine(t);n=n.filter(function(t){return null!==t});var o=Math.min.apply(this,n),r=Math.max.apply(this,n);if("number"==typeof i[a].min&&(o=Math.min(i[a].min,o)),"number"==typeof i[a].max&&(r=Math.max(i[a].max,r)),o===r){var s=r||1;o-=s,r+=s}for(var l=getDataRange(o,r),h=l.minRange,c=l.maxRange,d=[],x=(c-h)/e.yAxisSplit,g=0;g<=e.yAxisSplit;g++)d.push(h+x*g);return d.reverse()}function calYAxisData(t,i,e){var a="yAxis";"left"===t[0].position&&(a="leftYAxis"),"right"===t[0].position&&(a="rightYAxis");var n=getYAxisTextList(t,i,e),o=e.yAxisWidth,r=n.map(function(t){return t=util.toFixed(t,2),t=i[a].format?i[a].format(Number(t)):t,o=Math.max(o,measureText(t)+5),t});return!0===i[a].disabled&&(o=0),{rangesFormat:r,ranges:n,yAxisWidth:o}}function calCumulativeYAxisData(t,i,e){Array.prototype.max=function(){return Math.max.apply({},this)},Array.prototype.min=function(){return Math.min.apply({},this)};var a=Array(t[0].data.length).fill(0),n=Array(t[0].data.length).fill(0);t.forEach(function(t,i){t.data.forEach(function(t,i){t>=0?a[i]+=t:n[i]+=t})});var o=a.max(),r=n.min(),s=0,l=NaN,h=[],c=[],d=e.yAxisWidth;if(o>=0)if(r>=0){l=e.yAxisSplit,s=e.yAxisSplit;for(var x=getDataRange(0,o),g=x.maxRange/s,u=0;u<=s;u++)h.push(x.maxRange-g*u);c=h.map(function(t){return t=util.toFixed(t,2),t=i.yAxis.format?i.yAxis.format(Number(t)):t,d=Math.max(d,measureText(t)+5),t})}else{l=e.yAxisSplit;var f=getDataRange(0,o),p=f.maxRange/e.yAxisSplit;s=e.yAxisSplit+Math.ceil((0-r)/p);for(var m=0;m<=s;m++)h.push(f.maxRange-p*m);c=h.map(function(t){return t=util.toFixed(t,2),t=i.yAxis.format?i.yAxis.format(Number(t)):t,d=Math.max(d,measureText(t)+5),t})}else{l=0,s=e.yAxisSplit;for(var y=getDataRange(r,0),A=y.minRange,v=(0-A)/e.yAxisSplit,P=0;P<=s;P++)h.push(0-v*P);c=h.map(function(t){return t=util.toFixed(t,2),t=i.yAxis.format?i.yAxis.format(Number(t)):t,d=Math.max(d,measureText(t)+5),t})}return{splitNumber:s,zeroIndex:l,rangesFormat:c,ranges:h,yAxisWidth:d}}function drawPointShape(t,i,e,a){a.beginPath(),a.setStrokeStyle("#ffffff"),a.setLineWidth(1),a.setFillStyle(i),"diamond"===e?t.forEach(function(t,i){null!==t&&(a.moveTo(t.x,t.y-4.5),a.lineTo(t.x-4.5,t.y),a.lineTo(t.x,t.y+4.5),a.lineTo(t.x+4.5,t.y),a.lineTo(t.x,t.y-4.5))}):"circle"===e?t.forEach(function(t,i){null!==t&&(a.moveTo(t.x+3.5,t.y),a.arc(t.x,t.y,4,0,2*Math.PI,!1))}):"rect"===e?t.forEach(function(t,i){null!==t&&(a.moveTo(t.x-3.5,t.y-3.5),a.rect(t.x-3.5,t.y-3.5,7,7))}):"triangle"===e&&t.forEach(function(t,i){null!==t&&(a.moveTo(t.x,t.y-4.5),a.lineTo(t.x-4.5,t.y+4.5),a.lineTo(t.x+4.5,t.y+4.5),a.lineTo(t.x,t.y-4.5))}),a.closePath(),a.fill(),a.stroke()}function drawRingTitle(t,i,e){var a=t.title.fontSize||i.titleFontSize,n=t.subtitle.fontSize||i.subtitleFontSize,o=t.title.name||"",r=t.subtitle.name||"",s=t.title.color||i.titleColor,l=t.subtitle.color||i.subtitleColor,h=o?a:0,c=r?n:0;if(r){var d=measureText(r,n),x=(t.width-d)/2+(t.subtitle.offsetX||0),g=(t.height-i.legendHeight+n)/2;o&&(g-=(h+5)/2),e.beginPath(),e.setFontSize(n),e.setFillStyle(l),e.fillText(r,x,g),e.stroke(),e.closePath()}if(o){var u=measureText(o,a),f=(t.width-u)/2+(t.title.offsetX||0),p=(t.height-i.legendHeight+a)/2;r&&(p+=(c+5)/2),e.beginPath(),e.setFontSize(a),e.setFillStyle(s),e.fillText(o,f,p),e.stroke(),e.closePath()}}function drawPointText(t,i,e,a){var n=i.data;a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle("#666666"),t.forEach(function(t,e){if(null!==t){var o=i.format?i.format(n[e]):n[e];a.fillText(o,t.x-measureText(o)/2,t.y-2)}}),a.closePath(),a.stroke()}function drawRadarLabel(t,i,e,a,n,o){var r=a.extra.radar||{};i+=n.radarLabelTextMargin,o.beginPath(),o.setFontSize(n.fontSize),o.setFillStyle(r.labelColor||"#666666"),t.forEach(function(t,r){var s={x:i*Math.cos(t),y:i*Math.sin(t)},l=convertCoordinateOrigin(s.x,s.y,e),h=l.x,c=l.y;util.approximatelyEqual(s.x,0)?h-=measureText(a.categories[r]||"")/2:s.x<0&&(h-=measureText(a.categories[r]||"")),o.fillText(a.categories[r]||"",h,c+n.fontSize/2)}),o.stroke(),o.closePath()}function drawPieText(t,i,e,a,n,o){var r=n+e.pieChartLinePadding,s=[],l=null;t.map(function(t){return{arc:2*Math.PI-(t._start_+2*Math.PI*t._proportion_/2),text:t.format?t.format(+t._proportion_.toFixed(2)):util.toFixed(100*t._proportion_)+"%",color:t.color}}).forEach(function(t){var i=Math.cos(t.arc)*r,a=Math.sin(t.arc)*r,o=Math.cos(t.arc)*n,h=Math.sin(t.arc)*n,c=i>=0?i+e.pieChartTextPadding:i-e.pieChartTextPadding,d=a,x=measureText(t.text),g=d;l&&util.isSameXCoordinateArea(l.start,{x:c})&&(g=c>0?Math.min(d,l.start.y):i<0?Math.max(d,l.start.y):d>0?Math.max(d,l.start.y):Math.min(d,l.start.y)),c<0&&(c-=x);var u={lineStart:{x:o,y:h},lineEnd:{x:i,y:a},start:{x:c,y:g},width:x,height:e.fontSize,text:t.text,color:t.color};l=avoidCollision(u,l),s.push(l)}),s.forEach(function(t){var i=convertCoordinateOrigin(t.lineStart.x,t.lineStart.y,o),n=convertCoordinateOrigin(t.lineEnd.x,t.lineEnd.y,o),r=convertCoordinateOrigin(t.start.x,t.start.y,o);a.setLineWidth(1),a.setFontSize(e.fontSize),a.beginPath(),a.setStrokeStyle(t.color),a.setFillStyle(t.color),a.moveTo(i.x,i.y);var s=t.start.x<0?r.x+t.width:r.x,l=t.start.x<0?r.x-5:r.x+5;a.quadraticCurveTo(n.x,n.y,s,r.y),a.moveTo(i.x,i.y),a.stroke(),a.closePath(),a.beginPath(),a.moveTo(r.x+t.width,r.y),a.arc(s,r.y,2,0,2*Math.PI),a.closePath(),a.fill(),a.beginPath(),a.setFillStyle("#666666"),a.fillText(t.text,l,r.y+3),a.closePath(),a.stroke(),a.closePath()})}function drawToolTipSplitLine(t,i,e,a){var n=e.padding,o=i.height-e.padding-e.xAxisHeight-e.legendHeight;a.beginPath(),a.setStrokeStyle("#cccccc"),a.setLineWidth(1),a.moveTo(t,n),a.lineTo(t,o),a.stroke(),a.closePath()}function drawToolTip(t,i,e,a,n){var o=!1;i=assign({x:0,y:0},i),i.y-=8;var r=t.map(function(t){return measureText(t.text)}),s=9+4*a.toolTipPadding+Math.max.apply(null,r),l=2*a.toolTipPadding+t.length*a.toolTipLineHeight;i.x+8+s>e.width&&(o=!0),n.beginPath(),n.setFillStyle(e.tooltip.option.background||a.toolTipBackground),n.setGlobalAlpha(a.toolTipOpacity),o?(n.moveTo(i.x,i.y+10),n.lineTo(i.x-8,i.y+10-5),n.lineTo(i.x-8,i.y+10+5),n.moveTo(i.x,i.y+10),n.fillRect(i.x-s-8,i.y,s,l)):(n.moveTo(i.x,i.y+10),n.lineTo(i.x+8,i.y+10-5),n.lineTo(i.x+8,i.y+10+5),n.moveTo(i.x,i.y+10),n.fillRect(i.x+8,i.y,s,l)),n.closePath(),n.fill(),n.setGlobalAlpha(1),t.forEach(function(t,e){n.beginPath(),n.setFillStyle(t.color);var r=i.x+8+2*a.toolTipPadding,l=i.y+(a.toolTipLineHeight-a.fontSize)/2+a.toolTipLineHeight*e+a.toolTipPadding;o&&(r=i.x-s-8+2*a.toolTipPadding),n.fillRect(r,l,4,a.fontSize),n.closePath()}),n.beginPath(),n.setFontSize(a.fontSize),n.setFillStyle("#ffffff"),t.forEach(function(t,e){var r=i.x+8+2*a.toolTipPadding+4+5;o&&(r=i.x-s-8+2*a.toolTipPadding+4+5);var l=i.y+(a.toolTipLineHeight-a.fontSize)/2+a.toolTipLineHeight*e+a.toolTipPadding;n.fillText(t.text,r,l+a.fontSize)}),n.stroke(),n.closePath()}function drawYAxisTitle(t,i,e,a){var n=e.xAxisHeight+(i.height-e.xAxisHeight-measureText(t))/2;a.save(),a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle(i.yAxis.titleFontColor||"#333333"),a.translate(0,i.height),a.rotate(-90*Math.PI/180),a.fillText(t,n,e.padding+.5*e.fontSize),a.stroke(),a.closePath(),a.restore()}function drawColumnLineYAxisTitle(t,i,e){var a=t.yAxis.titleColumn,n=t.yAxis.titleLine,o=i.xAxisHeight+(t.height-i.xAxisHeight-measureText(a))/2;e.save(),e.beginPath(),e.setFontSize(i.fontSize),e.setFillStyle(t.colorColumn||"#333333"),e.translate(0,t.height),e.rotate(-90*Math.PI/180),a&&(e.fillText(a,o,i.padding+.5*i.fontSize),e.stroke()),e.closePath(),o=i.xAxisHeight+(t.height-i.xAxisHeight-measureText(n))/2,e.beginPath(),e.setFontSize(i.fontSize),e.setFillStyle(t.colorLine||"#333333"),n&&(e.fillText(n,o,t.width-i.padding-.5*i.fontSize),e.stroke()),e.closePath(),e.restore()}function drawColumnDataPoints(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=calYAxisData(t,i,e),r=o.ranges,s="column-line"===i.type?getColumnLineXAxisPoints(i.categories,i,e):getXAxisPoints(i.categories,i,e),l=s.xAxisPoints,h=s.eachSpacing,c=r.pop(),d=r.shift();return a.save(),i._scrollDistance_&&0!==i._scrollDistance_&&!0===i.enableScroll&&a.translate(i._scrollDistance_,0),t.forEach(function(o,r){var s=o.data,x=getDataPoints(s,c,d,l,h,i,e,n);x=fixColumeData(x,h,t.length,r,e,i),a.beginPath(),a.setFillStyle(o.color),x.forEach(function(t,n){if(null!==t){var o=t.x-t.width/2+1,r=i.height-t.y-e.padding-e.xAxisHeight-e.legendHeight;a.moveTo(o,t.y),a.rect(o,t.y,t.width-2,r)}}),a.closePath(),a.fill()}),t.forEach(function(o,r){var s=o.data,x=getDataPoints(s,c,d,l,h,i,e,n);x=fixColumeData(x,h,t.length,r,e,i),!1!==i.dataLabel&&1===n&&drawPointText(x,o,e,a)}),a.restore(),{xAxisPoints:l,eachSpacing:h}}function drawCumulativeDataPoints(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=calCumulativeYAxisData(t,i,e),r=o.splitNumber,s=o.zeroIndex,l=o.ranges,h=getXAxisPoints(i.categories,i,e),c=h.xAxisPoints,d=h.eachSpacing,x=l[l.length-1],g=l[0];a.save(),i._scrollDistance_&&0!==i._scrollDistance_&&!0===i.enableScroll&&a.translate(i._scrollDistance_,0);var u=i.height-2*e.padding-e.xAxisHeight-e.legendHeight,f=Array(t[0].data.length).fill(e.padding+s*u/r),p=Array(t[0].data.length).fill(e.padding+s*u/r);return t.forEach(function(t,i){var o=t.data,r=[];o.forEach(function(t,i){if(null===t)r.push(null);else{var e={};e.x=c[i]+Math.round(d/2);var a=u*Math.abs(t-0)/(g-x);a*=n,e.height=a,t>=0?(f[i]-=a,e.y=f[i]):(e.y=p[i],p[i]+=a),r.push(e)}}),r=fixCumulativeData(r,d,e),a.beginPath(),a.setFillStyle(t.color),r.forEach(function(t,i){if(null!==t){var e=t.x-t.width/2+1;a.moveTo(e,t.y),a.rect(e,t.y,t.width-2,t.height)}}),a.closePath(),a.fill()}),a.restore(),{xAxisPoints:c,eachSpacing:d}}function drawAreaDataPoints(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=calYAxisData(t,i,e),r=o.ranges,s=getXAxisPoints(i.categories,i,e),l=s.xAxisPoints,h=s.eachSpacing,c=r.pop(),d=r.shift(),x=i.height-e.padding-e.xAxisHeight-e.legendHeight,g=[];return a.save(),i._scrollDistance_&&0!==i._scrollDistance_&&!0===i.enableScroll&&a.translate(i._scrollDistance_,0),i.tooltip&&i.tooltip.textList&&i.tooltip.textList.length&&1===n&&drawToolTipSplitLine(i.tooltip.offset.x,i,e,a),t.forEach(function(t,o){var r=t.data,s=getDataPoints(r,c,d,l,h,i,e,n);if(g.push(s),splitPoints(s).forEach(function(e){if(a.beginPath(),a.setStrokeStyle(t.color),a.setFillStyle(t.color),a.setGlobalAlpha(.6),a.setLineWidth(2),e.length>1){var n=e[0],o=e[e.length-1];a.moveTo(n.x,n.y),"curve"===i.extra.lineStyle?e.forEach(function(t,i){if(i>0){var n=createCurveControlPoints(e,i-1);a.bezierCurveTo(n.ctrA.x,n.ctrA.y,n.ctrB.x,n.ctrB.y,t.x,t.y)}}):e.forEach(function(t,i){i>0&&a.lineTo(t.x,t.y)}),a.lineTo(o.x,x),a.lineTo(n.x,x),a.lineTo(n.x,n.y)}else{var r=e[0];a.moveTo(r.x-h/2,r.y),a.lineTo(r.x+h/2,r.y),a.lineTo(r.x+h/2,x),a.lineTo(r.x-h/2,x),a.moveTo(r.x-h/2,r.y)}a.closePath(),a.fill(),a.setGlobalAlpha(1)}),!1!==i.dataPointShape){var u=e.dataPointShape[o%e.dataPointShape.length];drawPointShape(s,t.color,u,a)}}),!1!==i.dataLabel&&1===n&&t.forEach(function(t,o){drawPointText(getDataPoints(t.data,c,d,l,h,i,e,n),t,e,a)}),a.restore(),{xAxisPoints:l,calPoints:g,eachSpacing:h}}function drawLineDataPoints(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=calYAxisData(t,i,e),r=o.ranges,s="column-line"===i.type?getColumnLineXAxisPoints(i.categories,i,e):getXAxisPoints(i.categories,i,e),l=s.xAxisPoints,h=s.eachSpacing,c=r.pop(),d=r.shift(),x=[];return a.save(),i._scrollDistance_&&0!==i._scrollDistance_&&!0===i.enableScroll&&a.translate(i._scrollDistance_,0),i.tooltip&&i.tooltip.textList&&i.tooltip.textList.length&&1===n&&drawToolTipSplitLine(i.tooltip.offset.x,i,e,a),t.forEach(function(t,o){var r=t.data,s=getDataPoints(r,c,d,l,h,i,e,n);if(x.push(s),splitPoints(s).forEach(function(e,n){a.beginPath(),a.setStrokeStyle(t.color),a.setLineWidth(2),1===e.length?(a.moveTo(e[0].x,e[0].y),a.arc(e[0].x,e[0].y,1,0,2*Math.PI)):(a.moveTo(e[0].x,e[0].y),"curve"===i.extra.lineStyle?e.forEach(function(t,i){if(i>0){var n=createCurveControlPoints(e,i-1);a.bezierCurveTo(n.ctrA.x,n.ctrA.y,n.ctrB.x,n.ctrB.y,t.x,t.y)}}):e.forEach(function(t,i){i>0&&a.lineTo(t.x,t.y)}),a.moveTo(e[0].x,e[0].y)),a.closePath(),a.stroke()}),!1!==i.dataPointShape){var g=e.dataPointShape[o%e.dataPointShape.length];drawPointShape(s,t.color,g,a)}}),!1!==i.dataLabel&&1===n&&t.forEach(function(t,o){drawPointText(getDataPoints(t.data,c,d,l,h,i,e,n),t,e,a)}),a.restore(),{xAxisPoints:l,calPoints:x,eachSpacing:h}}function drawToolTipBridge(t,i,e,a){e.save(),t._scrollDistance_&&0!==t._scrollDistance_&&!0===t.enableScroll&&e.translate(t._scrollDistance_,0),t.tooltip&&t.tooltip.textList&&t.tooltip.textList.length&&1===a&&drawToolTip(t.tooltip.textList,t.tooltip.offset,t,i,e),e.restore()}function drawXAxis(t,i,e,a){var n=getXAxisPoints(t,i,e),o=n.xAxisPoints,r=(n.startX,n.endX,n.eachSpacing),s=i.height-e.padding-e.xAxisHeight-e.legendHeight,l=s+e.xAxisLineHeight;a.save(),i._scrollDistance_&&0!==i._scrollDistance_&&a.translate(i._scrollDistance_,0),a.beginPath(),a.setStrokeStyle(i.xAxis.gridColor||"#cccccc"),!0!==i.xAxis.disableGrid&&("calibration"===i.xAxis.type?o.forEach(function(t,i){i>0&&(a.moveTo(t-r/2,s),a.lineTo(t-r/2,s+4))}):o.forEach(function(t,i){a.moveTo(t,s),a.lineTo(t,l)})),a.closePath(),a.stroke();var h=i.width-2*e.padding-e.yAxisWidth-e.yAxisTitleWidth,c=Math.min(t.length,Math.ceil(h/e.fontSize/1.5)),d=Math.ceil(t.length/c);t=t.map(function(t,i){return i%d!=0?"":t}),0===e._xAxisTextAngle_?(a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle(i.xAxis.fontColor||"#666666"),t.forEach(function(t,i){var n=r/2-measureText(t)/2;a.fillText(t,o[i]+n,s+e.fontSize+5)}),a.closePath(),a.stroke()):t.forEach(function(t,n){a.save(),a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle(i.xAxis.fontColor||"#666666");var l=measureText(t),h=r/2-l,c=calRotateTranslate(o[n]+r/2,s+e.fontSize/2+5,i.height),d=c.transX,x=c.transY;a.rotate(-1*e._xAxisTextAngle_),a.translate(d,x),a.fillText(t,o[n]+h,s+e.fontSize+5),a.closePath(),a.stroke(),a.restore()}),a.restore()}function drawColumnLineXAxis(t,i,e,a){var n=getColumnLineXAxisPoints(t,i,e),o=n.xAxisPoints,r=n.startX,s=n.endX,l=n.eachSpacing,h=i.height-e.padding-e.xAxisHeight-e.legendHeight,c=h+e.xAxisLineHeight;a.beginPath(),a.setStrokeStyle(i.xAxis.gridColor||"#cccccc"),a.setLineWidth(1),a.moveTo(r,h),a.lineTo(s,h),!0!==i.xAxis.disableGrid&&("calibration"===i.xAxis.type?o.forEach(function(t,i){i>0&&(a.moveTo(t-l/2,h),a.lineTo(t-l/2,h+4))}):o.forEach(function(t,i){a.moveTo(t,h),a.lineTo(t,c)})),a.closePath(),a.stroke();var d=e.columnLine.leftYAxisWidth+e.columnLine.leftYAxisTitleWidth,x=e.columnLine.rightYAxisWidth+e.columnLine.rightYAxisTitleWidth,g=i.width-2*e.padding-d-x,u=Math.min(t.length,Math.ceil(g/e.fontSize/1.5)),f=Math.ceil(t.length/u);t=t.map(function(t,i){return i%f!=0?"":t}),0===e._xAxisTextAngle_?(a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle(i.xAxis.fontColor||"#666666"),t.forEach(function(t,i){var n=l/2-measureText(t)/2;a.fillText(t,o[i]+n,h+e.fontSize+5)}),a.closePath(),a.stroke()):t.forEach(function(t,n){a.save(),a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle(i.xAxis.fontColor||"#666666");var r=measureText(t),s=l/2-r,c=calRotateTranslate(o[n]+l/2,h+e.fontSize/2+5,i.height),d=c.transX,x=c.transY;a.rotate(-1*e._xAxisTextAngle_),a.translate(d,x),a.fillText(t,o[n]+s,h+e.fontSize+5),a.closePath(),a.stroke(),a.restore()})}function drawYAxisGrid(t,i,e){for(var a=t.height-2*i.padding-i.xAxisHeight-i.legendHeight,n=Math.floor(a/i.yAxisSplit),o=i.yAxisWidth+i.yAxisTitleWidth,r=i.padding+o,s=t.width-i.padding,l=[],h=0;h<i.yAxisSplit;h++)l.push(i.padding+n*h);l.push(i.padding+n*i.yAxisSplit+2),e.beginPath(),e.setStrokeStyle(t.yAxis.gridColor||"#cccccc"),e.setLineWidth(1),l.forEach(function(t,i){e.moveTo(r,t),e.lineTo(s,t)}),e.closePath(),e.stroke()}function drawCumulativeYAxisGrid(t,i,e,a){for(var n=calCumulativeYAxisData(t,i,e),o=n.splitNumber,r=i.height-2*e.padding-e.xAxisHeight-e.legendHeight,s=Math.floor(r/o),l=e.yAxisWidth+e.yAxisTitleWidth,h=e.padding+l,c=i.width-e.padding,d=[],x=0;x<o;x++)d.push(e.padding+s*x);d.push(e.padding+s*o+2),a.beginPath(),a.setStrokeStyle(i.yAxis.gridColor||"#cccccc"),a.setLineWidth(1),d.forEach(function(t,i){a.moveTo(h,t),a.lineTo(c,t)}),a.closePath(),a.stroke()}function drawYAxis(t,i,e,a){if(!0!==i.yAxis.disabled){var n=calYAxisData(t,i,e),o=n.rangesFormat,r=e.yAxisWidth+e.yAxisTitleWidth,s=i.height-2*e.padding-e.xAxisHeight-e.legendHeight,l=Math.floor(s/e.yAxisSplit),h=e.padding+r,c=i.width-e.padding,d=i.height-e.padding-e.xAxisHeight-e.legendHeight;a.setFillStyle(i.background||"#FFFFFF"),i._scrollDistance_<0&&a.fillRect(0,0,h,d+e.xAxisHeight+5),a.fillRect(c,0,i.width,d+e.xAxisHeight+5);for(var x=[],g=0;g<=e.yAxisSplit;g++)x.push(e.padding+l*g);a.stroke(),a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle(i.yAxis.fontColor||"#666666"),o.forEach(function(t,i){var n=x[i]?x[i]:d;a.fillText(t,e.padding+e.yAxisTitleWidth,n+e.fontSize/2)}),a.closePath(),a.stroke(),i.yAxis.title&&drawYAxisTitle(i.yAxis.title,i,e,a)}}function drawCumulativeYAxis(t,i,e,a){if(!0!==i.yAxis.disabled){var n=calCumulativeYAxisData(t,i,e),o=n.splitNumber,r=n.rangesFormat,s=e.yAxisWidth+e.yAxisTitleWidth,l=i.height-2*e.padding-e.xAxisHeight-e.legendHeight,h=Math.floor(l/o),c=e.padding+s,d=i.width-e.padding,x=i.height-e.padding-e.xAxisHeight-e.legendHeight;a.setFillStyle(i.background||"#FFFFFF"),i._scrollDistance_<0&&a.fillRect(0,0,c,x+e.xAxisHeight+5),a.fillRect(d,0,i.width,x+e.xAxisHeight+5);for(var g=[],u=0;u<=o;u++)g.push(e.padding+h*u);a.stroke(),a.beginPath(),a.setFontSize(e.fontSize),a.setFillStyle(i.yAxis.fontColor||"#666666"),r.forEach(function(t,i){var n=g[i]?g[i]:x;a.fillText(t,e.padding+e.yAxisTitleWidth,n+e.fontSize/2)}),a.closePath(),a.stroke(),i.yAxis.title&&drawYAxisTitle(i.yAxis.title,i,e,a)}}function drawColumnLineYAxis(t,i,e,a,n){if(!0!==e.yAxis.disabled){for(var o=calYAxisData(t,e,a),r=calYAxisData(i,e,a),s=a.columnLine.leftYAxisWidth+a.columnLine.leftYAxisTitleWidth,l=a.columnLine.rightYAxisWidth+a.columnLine.rightYAxisTitleWidth,h=e.height-2*a.padding-a.xAxisHeight-a.legendHeight,c=Math.floor(h/a.yAxisSplit),d=a.padding+s,x=e.width-a.padding-l,g=e.height-a.padding-a.xAxisHeight-a.legendHeight,u=[],f=0;f<a.yAxisSplit;f++)u.push(a.padding+c*f);n.beginPath(),n.setStrokeStyle(e.yAxis.gridColor||"#cccccc"),n.setLineWidth(1),u.forEach(function(t,i){n.moveTo(d,t),n.lineTo(x,t)}),n.closePath(),n.stroke(),n.beginPath(),n.setFontSize(a.fontSize),n.setFillStyle(t[0].color||"#666666"),o.rangesFormat.forEach(function(t,i){var e=u[i]?u[i]:g;n.fillText(t,a.padding+a.columnLine.leftYAxisTitleWidth,e+a.fontSize/2)}),n.closePath(),n.stroke(),n.beginPath(),n.setFontSize(a.fontSize),n.setFillStyle(i[0].color||"#666666"),r.rangesFormat.forEach(function(t,i){var e=u[i]?u[i]:g;n.fillText(t,x,e+a.fontSize/2)}),n.closePath(),n.stroke(),drawColumnLineYAxisTitle(e,a,n)}}function drawLegend(t,i,e,a){if(i.legend){var n=calLegendData(t,i,e),o=n.legendList;o.forEach(function(t,n){var o=0;t.forEach(function(t){t.name=t.name||"undefined",o+=15+measureText(t.name)+15});var r=(i.width-o)/2+5,s=i.height-e.padding-e.legendHeight+n*(e.fontSize+8)+5+8;a.setFontSize(e.fontSize),t.forEach(function(t){switch(i.type){case"line":a.beginPath(),a.setLineWidth(1),a.setStrokeStyle(t.color),a.moveTo(r-2,s+5),a.lineTo(r+17,s+5),a.stroke(),a.closePath(),a.beginPath(),a.setLineWidth(1),a.setStrokeStyle("#ffffff"),a.setFillStyle(t.color),a.moveTo(r+7.5,s+5),a.arc(r+7.5,s+5,4,0,2*Math.PI),a.fill(),a.stroke(),a.closePath();break;case"pie":case"ring":a.beginPath(),a.setFillStyle(t.color),a.moveTo(r+7.5,s+5),a.arc(r+7.5,s+5,7,0,2*Math.PI),a.closePath(),a.fill();break;default:a.beginPath(),a.setFillStyle(t.color),a.moveTo(r,s),a.rect(r,s,15,10),a.closePath(),a.fill()}r+=20,a.beginPath(),a.setFillStyle(i.extra.legendTextColor||"#333333"),a.fillText(t.name,r,s+9),a.closePath(),a.stroke(),r+=measureText(t.name)+10})})}}function drawColumnLineLegend(t,i,e,a,n){if(e.legend){var o=t.concat(i),r=calLegendData(o,e,a),s=r.legendList,l=t.length,h=0;s.forEach(function(t,i){var o=0;t.forEach(function(t){t.name=t.name||"undefined",o+=15+measureText(t.name)+15});var r=(e.width-o)/2+5,s=e.height-a.padding-a.legendHeight+i*(a.fontSize+8)+5+8;n.setFontSize(a.fontSize),t.forEach(function(t){h<l?(n.beginPath(),n.setFillStyle(t.color),n.moveTo(r,s),n.rect(r,s,15,10),n.closePath(),n.fill()):(n.beginPath(),n.setLineWidth(1),n.setStrokeStyle(t.color),n.moveTo(r-2,s+5),n.lineTo(r+17,s+5),n.stroke(),n.closePath(),n.beginPath(),n.setLineWidth(1),n.setStrokeStyle("#ffffff"),n.setFillStyle(t.color),n.moveTo(r+7.5,s+5),n.arc(r+7.5,s+5,4,0,2*Math.PI),n.fill(),n.stroke(),n.closePath()),r+=20,n.beginPath(),n.setFillStyle(e.extra.legendTextColor||"#333333"),n.fillText(t.name,r,s+9),n.closePath(),n.stroke(),r+=measureText(t.name)+10,h+=1})})}}function drawPieDataPoints(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=i.extra.pie||{};t=getPieDataPoints(t,n);var r={x:i.width/2,y:(i.height-e.legendHeight)/2},s=Math.min(r.x-e.pieChartLinePadding-e.pieChartTextPadding-e._pieTextMaxLength_,r.y-e.pieChartLinePadding-e.pieChartTextPadding);if(i.dataLabel?s-=10:s-=2*e.padding,t=t.map(function(t){return t._start_+=(o.offsetAngle||0)*Math.PI/180,t}),t.forEach(function(t){a.beginPath(),a.setLineWidth(2),a.setStrokeStyle("#ffffff"),a.setFillStyle(t.color),a.moveTo(r.x,r.y),a.arc(r.x,r.y,s,t._start_,t._start_+2*t._proportion_*Math.PI),a.closePath(),a.fill(),!0!==i.disablePieStroke&&a.stroke()}),"ring"===i.type){var l=.6*s;"number"==typeof i.extra.ringWidth&&i.extra.ringWidth>0&&(l=Math.max(0,s-i.extra.ringWidth)),a.beginPath(),a.setFillStyle(i.background||"#ffffff"),a.moveTo(r.x,r.y),a.arc(r.x,r.y,l,0,2*Math.PI),a.closePath(),a.fill()}if(!1!==i.dataLabel&&1===n){for(var h=!1,c=0,d=t.length;c<d;c++)if(t[c].data>0){h=!0;break}h&&drawPieText(t,i,e,a,s,r)}return 1===n&&"ring"===i.type&&drawRingTitle(i,e,a),{center:r,radius:s,series:t}}function drawRadarDataPoints(t,i,e,a){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=i.extra.radar||{},r=getRadarCoordinateSeries(i.categories.length),s={x:i.width/2,y:(i.height-e.legendHeight)/2},l=Math.min(s.x-(getMaxTextListLength(i.categories)+e.radarLabelTextMargin),s.y-e.radarLabelTextMargin);l-=e.padding,a.beginPath(),a.setLineWidth(1),a.setStrokeStyle(o.gridColor||"#cccccc"),r.forEach(function(t){var i=convertCoordinateOrigin(l*Math.cos(t),l*Math.sin(t),s);a.moveTo(s.x,s.y),a.lineTo(i.x,i.y)}),a.stroke(),a.closePath();for(var h=1;h<=e.radarGridCount;h++)!function(t){var i={};a.beginPath(),a.setLineWidth(1),a.setStrokeStyle(o.gridColor||"#cccccc"),r.forEach(function(n,o){var r=convertCoordinateOrigin(l/e.radarGridCount*t*Math.cos(n),l/e.radarGridCount*t*Math.sin(n),s);0===o?(i=r,a.moveTo(r.x,r.y)):a.lineTo(r.x,r.y)}),a.lineTo(i.x,i.y),a.stroke(),a.closePath()}(h);return getRadarDataPoints(r,s,l,t,i,n).forEach(function(t,n){if(a.beginPath(),a.setFillStyle(t.color),a.setGlobalAlpha(.6),t.data.forEach(function(t,i){0===i?a.moveTo(t.position.x,t.position.y):a.lineTo(t.position.x,t.position.y)}),a.closePath(),a.fill(),a.setGlobalAlpha(1),!1!==i.dataPointShape){var o=e.dataPointShape[n%e.dataPointShape.length];drawPointShape(t.data.map(function(t){return t.position}),t.color,o,a)}}),drawRadarLabel(r,l,s,i,e,a),{center:s,radius:l,angleList:r}}function drawCanvas(t,i,e){i.draw(e)}function Animation(t){this.isStop=!1,t.duration=void 0===t.duration?1e3:t.duration,t.timing=t.timing||"linear";var i=function(){return"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setTimeout?function(t,i){setTimeout(function(){var i=+new Date;t(i)},i)}:function(t){t(null)}}(),e=null,a=function(n){if(null===n||!0===this.isStop)return t.onProcess&&t.onProcess(1),void(t.onAnimationFinish&&t.onAnimationFinish());if(null===e&&(e=n),n-e<t.duration){var o=(n-e)/t.duration;o=(0,Timing[t.timing])(o),t.onProcess&&t.onProcess(o),i(a,17)}else t.onProcess&&t.onProcess(1),
t.onAnimationFinish&&t.onAnimationFinish()};a=a.bind(this),i(a,17)}function drawCharts(t,i,e,a){var n=this,o=i.series,r=i.seriesColumn,s=i.seriesLine,l=i.categories;if("column-line"===t){r=fillSeriesColor(r,e),s=fillSeriesColor(s,e),o=r.concat(s);var h=calLegendData(o,i,e),c=h.legendHeight;e.legendHeight=c;var d=calYAxisData(r,i,e),x=calYAxisData(s,i,e);if(e.columnLine.leftYAxisWidth=d.yAxisWidth,e.columnLine.rightYAxisWidth=x.yAxisWidth,l&&l.length){var g=calCategoriesData(l,i,e),u=g.xAxisHeight,f=g.angle;e.xAxisHeight=u,e._xAxisTextAngle_=f}}else{o=fillSeriesColor(o,e);var p=calLegendData(o,i,e),m=p.legendHeight;e.legendHeight=m;var y="cumulative"===t?calCumulativeYAxisData(o,i,e):calYAxisData(o,i,e),A=y.yAxisWidth;if(e.yAxisWidth=A,l&&l.length){var v=calCategoriesData(l,i,e),P=v.xAxisHeight,T=v.angle;e.xAxisHeight=P,e._xAxisTextAngle_=T}"pie"!==t&&"ring"!==t||(e._pieTextMaxLength_=!1===i.dataLabel?0:getPieTextMaxLength(o))}var S=i.animation?1e3:0;switch(this.animationInstance&&this.animationInstance.stop(),t){case"cumulative":this.animationInstance=new Animation({timing:"easeIn",duration:S,onProcess:function(t){drawCumulativeYAxisGrid(o,i,e,a);var r=drawCumulativeDataPoints(o,i,e,a,t),s=r.xAxisPoints,h=r.eachSpacing;n.chartData.xAxisPoints=s,n.chartData.eachSpacing=h,drawXAxis(l,i,e,a),drawLegend(i.series,i,e,a),drawCumulativeYAxis(o,i,e,a),drawCanvas(i,a,!1)},onAnimationFinish:function(){n.event.trigger("renderComplete")}});break;case"column-line":drawColumnLineYAxis(r,s,i,e,a),drawColumnLineXAxis(l,i,e,a),drawColumnDataPoints(r,i,e,a),drawCanvas(i,a,!1);var C=drawLineDataPoints(s,i,e,a),w=C.xAxisPoints,b=C.calPoints;this.chartData.xAxisPoints=w,this.chartData.calPoints=b,drawColumnLineLegend(r,s,i,e,a),drawCanvas(i,a,!0);break;case"line":this.animationInstance=new Animation({timing:"easeIn",duration:S,onProcess:function(t){drawYAxisGrid(i,e,a);var r=drawLineDataPoints(o,i,e,a,t),s=r.xAxisPoints,h=r.calPoints,c=r.eachSpacing;n.chartData.xAxisPoints=s,n.chartData.calPoints=h,n.chartData.eachSpacing=c,drawXAxis(l,i,e,a),drawLegend(i.series,i,e,a),drawYAxis(o,i,e,a),drawToolTipBridge(i,e,a,t),drawCanvas(i,a,!1)},onAnimationFinish:function(){n.event.trigger("renderComplete")}});break;case"column":this.animationInstance=new Animation({timing:"easeIn",duration:S,onProcess:function(t){drawYAxisGrid(i,e,a);var r=drawColumnDataPoints(o,i,e,a,t),s=r.xAxisPoints,h=r.eachSpacing;n.chartData.xAxisPoints=s,n.chartData.eachSpacing=h,drawXAxis(l,i,e,a),drawLegend(i.series,i,e,a),drawYAxis(o,i,e,a),drawCanvas(i,a,!1)},onAnimationFinish:function(){n.event.trigger("renderComplete")}});break;case"area":this.animationInstance=new Animation({timing:"easeIn",duration:S,onProcess:function(t){drawYAxisGrid(i,e,a);var r=drawAreaDataPoints(o,i,e,a,t),s=r.xAxisPoints,h=r.calPoints,c=r.eachSpacing;n.chartData.xAxisPoints=s,n.chartData.calPoints=h,n.chartData.eachSpacing=c,drawXAxis(l,i,e,a),drawLegend(i.series,i,e,a),drawYAxis(o,i,e,a),drawToolTipBridge(i,e,a,t),drawCanvas(i,a,!1)},onAnimationFinish:function(){n.event.trigger("renderComplete")}});break;case"ring":case"pie":this.animationInstance=new Animation({timing:"easeInOut",duration:S,onProcess:function(t){n.chartData.pieData=drawPieDataPoints(o,i,e,a,t),drawLegend(i.series,i,e,a),drawCanvas(i,a,!1)},onAnimationFinish:function(){n.event.trigger("renderComplete")}});break;case"radar":this.animationInstance=new Animation({timing:"easeInOut",duration:S,onProcess:function(t){n.chartData.radarData=drawRadarDataPoints(o,i,e,a,t),drawLegend(i.series,i,e,a),drawCanvas(i,a,!1)},onAnimationFinish:function(){n.event.trigger("renderComplete")}})}}function Event(){this.events={}}var config={yAxisWidth:15,yAxisSplit:5,xAxisHeight:15,xAxisLineHeight:15,legendHeight:15,yAxisTitleWidth:15,columnLine:{leftYAxisWidth:15,leftYAxisTitleWidth:15,rightYAxisWidth:15,rightYAxisTitleWidth:15},padding:12,columePadding:3,fontSize:10,dataPointShape:["circle","diamond","triangle","rect"],colors:["#7cb5ec","#f7a35c","#434348","#90ed7d","#f15c80","#8085e9"],pieChartLinePadding:25,pieChartTextPadding:15,xAxisTextPadding:3,titleColor:"#333333",titleFontSize:20,subtitleColor:"#999999",subtitleFontSize:15,toolTipPadding:3,toolTipBackground:"#000000",toolTipOpacity:.7,toolTipLineHeight:14,radarGridCount:3,radarLabelTextMargin:15},util={toFixed:function(t,i){return i=i||2,this.isFloat(t)&&(t=t.toFixed(i)),t},isFloat:function(t){return t%1!=0},approximatelyEqual:function(t,i){return Math.abs(t-i)<1e-10},isSameSign:function(t,i){return Math.abs(t)===t&&Math.abs(i)===i||Math.abs(t)!==t&&Math.abs(i)!==i},isSameXCoordinateArea:function(t,i){return this.isSameSign(t.x,i.x)},isCollision:function(t,i){return t.end={},t.end.x=t.start.x+t.width,t.end.y=t.start.y-t.height,i.end={},i.end.x=i.start.x+i.width,i.end.y=i.start.y-i.height,!(i.start.x>t.end.x||i.end.x<t.start.x||i.end.y>t.start.y||i.start.y<t.end.y)}},Timing={easeIn:function(t){return Math.pow(t,3)},easeOut:function(t){return Math.pow(t-1,3)+1},easeInOut:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},linear:function(t){return t}};Animation.prototype.stop=function(){this.isStop=!0},Event.prototype.addEventListener=function(t,i){this.events[t]=this.events[t]||[],this.events[t].push(i)},Event.prototype.trigger=function(){for(var t=arguments.length,i=Array(t),e=0;e<t;e++)i[e]=arguments[e];var a=i[0],n=i.slice(1);this.events[a]&&this.events[a].forEach(function(t){try{t.apply(null,n)}catch(t){console.error(t)}})};var Charts=function(t){t.title=t.title||{},t.subtitle=t.subtitle||{},t.yAxis=t.yAxis||{},t.xAxis=t.xAxis||{},t.extra=t.extra||{},t.legend=!1!==t.legend,t.animation=!1!==t.animation;var i=assign({},config);i.yAxisTitleWidth=!0!==t.yAxis.disabled&&t.yAxis.title?i.yAxisTitleWidth:0,i.columnLine.leftYAxisTitleWidth=!0!==t.leftYAxis.disabled&&t.leftYAxis.titleColumn?i.columnLine.leftYAxisTitleWidth:0,i.columnLine.rightYAxisTitleWidth=!0!==t.rightYAxis.disabled&&t.rightYAxis.titleLine?i.columnLine.rightYAxisTitleWidth:0,i.pieChartLinePadding=!1===t.dataLabel?0:i.pieChartLinePadding,i.pieChartTextPadding=!1===t.dataLabel?0:i.pieChartTextPadding,this.opts=t,this.config=i,this.context=wx.createCanvasContext(t.canvasId),this.chartData={},this.event=new Event,this.scrollOption={currentOffset:0,startTouchX:0,distance:0},drawCharts.call(this,t.type,t,i,this.context)};Charts.prototype.updateData=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.opts.series=t.series||this.opts.series,this.opts.categories=t.categories||this.opts.categories,this.opts.seriesColumn=t.seriesColumn||this.opts.seriesColumn,this.opts.seriesLine=t.seriesLine||this.opts.seriesLine,this.opts.title=assign({},this.opts.title,t.title||{}),this.opts.subtitle=assign({},this.opts.subtitle,t.subtitle||{}),drawCharts.call(this,this.opts.type,this.opts,this.config,this.context)},Charts.prototype.stopAnimation=function(){this.animationInstance&&this.animationInstance.stop()},Charts.prototype.addEventListener=function(t,i){this.event.addEventListener(t,i)},Charts.prototype.getCurrentDataIndex=function(t){var i=t.touches&&t.touches.length?t.touches:t.changedTouches;if(i&&i.length){var e=i[0],a=e.x,n=e.y;return"pie"===this.opts.type||"ring"===this.opts.type?findPieChartCurrentIndex({x:a,y:n},this.chartData.pieData):"radar"===this.opts.type?findRadarChartCurrentIndex({x:a,y:n},this.chartData.radarData,this.opts.categories.length):findCurrentIndex({x:a,y:n},this.chartData.xAxisPoints,this.opts,this.config,Math.abs(this.scrollOption.currentOffset))}return-1},Charts.prototype.showToolTip=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("line"===this.opts.type||"area"===this.opts.type){var e=this.getCurrentDataIndex(t),a=this.scrollOption.currentOffset,n=assign({},this.opts,{_scrollDistance_:a,animation:!1});if(e>-1){var o=getSeriesDataItem(this.opts.series,e);if(0===o.length)drawCharts.call(this,n.type,n,this.config,this.context);else{var r=getToolTipData(o,this.chartData.calPoints,e,this.opts.categories,i),s=r.textList,l=r.offset;n.tooltip={textList:s,offset:l,option:i},drawCharts.call(this,n.type,n,this.config,this.context)}}else drawCharts.call(this,n.type,n,this.config,this.context)}},Charts.prototype.scrollStart=function(t){t.touches[0]&&!0===this.opts.enableScroll&&(this.scrollOption.startTouchX=t.touches[0].x)},Charts.prototype.scroll=function(t){if(t.touches[0]&&!0===this.opts.enableScroll){var i=t.touches[0].x-this.scrollOption.startTouchX,e=this.scrollOption.currentOffset,a=calValidDistance(e+i,this.chartData,this.config,this.opts);this.scrollOption.distance=i=a-e;var n=assign({},this.opts,{_scrollDistance_:e+i,animation:!1});drawCharts.call(this,n.type,n,this.config,this.context)}},Charts.prototype.scrollEnd=function(t){if(!0===this.opts.enableScroll){var i=this.scrollOption,e=i.currentOffset,a=i.distance;this.scrollOption.currentOffset=e+a,this.scrollOption.distance=0}},module.exports=Charts;
